/* =========================================================
   Sticker Embed Modal – Layout + Mobile Fix
   Desktop: 40/60 (Config/Preview)
   Mobile: Preview oben FIX, Config unten scrollt
   ========================================================= */

/* ------------------------------
   Backdrop root (optional)
-------------------------------- */
#sc-modal-root {
  position: fixed;
  inset: 0;
  z-index: 2147483646;
  pointer-events: none;
}

#sc-modal-root.sc-open {
  pointer-events: auto;
}

body.sc-lock,
body.sc-overlay-open {
  overflow: hidden !important;
}

/* Backdrop */
.sc-modalOverlay,
#sc-modal-root.sc-open .sticker-embed-backdrop,
#sc-modal-root.sc-open .sticker-embed-backdrop-open {
  position: fixed !important;
  inset: 0 !important;
  background: rgba(0,0,0,.55);
  z-index: 2147483646 !important;
}

/* Close button (falls genutzt) */
.sc-modalClose {
  position: fixed;
  top: 10px;
  right: 12px;
  width: 40px;
  height: 40px;
  border: 0;
  border-radius: 10px;
  background: rgba(255,255,255,.08);
  color: #fff;
  font-size: 26px;
  line-height: 1;
  cursor: pointer;
  z-index: 2147483647;
}

/* =========================================================
   Fullscreen Modal (robust)
   ========================================================= */
body.sc-overlay-open [data-block-handle="sticker-configurator"] .sticker-embed-modal,
#sc-modal-root.sc-open .sticker-embed-modal,
#sc-modal-root.sc-open .sticker-embed-modal-open {
  position: fixed !important;
  inset: 0 !important;
  width: 100vw !important;
  height: 100dvh !important;
  max-width: none !important;
  max-height: none !important;
  margin: 0 !important;

  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;

  background: #0b0f14 !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  overflow: hidden !important;

  z-index: 2147483647 !important;
  transform: none !important;
}

/* Dialog nimmt volle Fläche */
#sc-modal-root.sc-open .sticker-embed-dialog,
body.sc-overlay-open [data-block-handle="sticker-configurator"] .sticker-embed-modal .sticker-embed-dialog {
  width: 100% !important;
  height: 100% !important;
  max-width: none !important;
  max-height: none !important;
  margin: 0 !important;
  padding: 0 !important;
  border-radius: 0 !important;
  overflow: hidden !important;
}

/* React root volle Fläche */
#sc-modal-root.sc-open .sticker-embed-react-root {
  width: 100% !important;
  height: 100% !important;
  min-height: 0 !important;
  overflow: hidden !important;
}

/* =========================================================
   1) DESKTOP Layout: 40/60 (Config/Preview)
   - Config scrollbar
   - Preview centered
   ========================================================= */
#sc-modal-root.sc-open .sticker-embed-react-root {
  display: grid !important;
  grid-template-columns: 40% 60% !important;
  grid-template-rows: 1fr !important;
}

#sc-modal-root.sc-open .sticker-embed-react-root > * {
  min-height: 0;
}

/* Config (1. Kind) links: scroll */
#sc-modal-root.sc-open .sticker-embed-react-root > *:nth-child(1) {
  grid-column: 1;
  grid-row: 1;
  overflow: auto !important;
  -webkit-overflow-scrolling: touch;
  padding: 16px 16px calc(16px + env(safe-area-inset-bottom)) !important;
  border-right: 1px solid rgba(255,255,255,0.08) !important;
  background: #0b0f14;
}

/* Preview (2. Kind) rechts: fix + centered */
#sc-modal-root.sc-open .sticker-embed-react-root > *:nth-child(2) {
  grid-column: 2;
  grid-row: 1;
  overflow: hidden !important;

  display: flex !important;
  align-items: center !important;
  justify-content: center !important;

  padding: 18px !important;
  background: #0b0f14;
}

/* Preview Inhalt soll nie ausbrechen */
#sc-modal-root.sc-open .sticker-embed-react-root > *:nth-child(2) img,
#sc-modal-root.sc-open .sticker-embed-react-root > *:nth-child(2) canvas,
#sc-modal-root.sc-open .sticker-embed-react-root > *:nth-child(2) svg,
#sc-modal-root.sc-open .sticker-embed-react-root > *:nth-child(2) * {
  max-width: 100% !important;
  max-height: 100% !important;
}

/* =========================================================
   2) MOBILE Layout:
   Preview oben FEST (bleibt sichtbar),
   Config unten scrollt (nur der Config-Bereich!)
   ========================================================= */

/* Breakpoint kannst du anpassen (900px passt meist gut) */
@media (max-width: 900px) {
  #sc-modal-root.sc-open .sticker-embed-react-root {
    grid-template-columns: 1fr !important;
    /* obere Preview-Höhe: 50% Viewport, unten Rest */
    grid-template-rows: 50dvh 1fr !important;
  }

  /* Preview oben (2. Kind) */
  #sc-modal-root.sc-open .sticker-embed-react-root > *:nth-child(2) {
    grid-column: 1 / -1;
    grid-row: 1;

    /* bleibt sichtbar */
    overflow: hidden !important;
    padding: 12px !important;

    /* leichte Abgrenzung */
    border-bottom: 1px solid rgba(255,255,255,0.08) !important;
  }

  /* Config unten (1. Kind) -> EINZIGER Scrollbereich */
  #sc-modal-root.sc-open .sticker-embed-react-root > *:nth-child(1) {
    grid-column: 1 / -1;
    grid-row: 2;

    overflow: auto !important;
    -webkit-overflow-scrolling: touch;

    /* damit iOS nicht “drüber” scrollt */
    overscroll-behavior: contain;

    border-right: 0 !important;
    border-top: 0 !important;

    /* Sheet Look */
    background: rgba(10, 14, 20, 0.94);
    backdrop-filter: blur(10px);

    padding: 14px 14px calc(14px + env(safe-area-inset-bottom)) !important;
  }
}

/* =========================================================
   3) EXTRA: sehr kleine Höhen (Landscape iPhone)
   Preview etwas kleiner, damit Config nutzbar bleibt
   ========================================================= */
@media (max-width: 900px) and (max-height: 720px) {
  #sc-modal-root.sc-open .sticker-embed-react-root {
    grid-template-rows: 44dvh 1fr !important;
  }
}

/* =========================================================
   Buttons optional full width (app-like)
   ========================================================= */
#sc-modal-root.sc-open .sticker-embed-react-root button {
  width: 100%;
}
