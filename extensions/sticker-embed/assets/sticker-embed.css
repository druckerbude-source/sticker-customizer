/* =========================================================
   Sticker Embed CSS (robust)
   - Modal-Visibility sicher über aria-hidden / open-Klassen
   - Keine Layout-Annahmen (kein nth-child)
   - Layout passiert im React-UI (StickerCanvasClient)
   ========================================================= */

/* ---------- CTA Button im Produktbereich ---------- */
.sticker-embed-button{
  width: 100% !important;
  display: block;
  box-sizing: border-box;
  padding: 14px 16px;
  border-radius: 999px;
  border: 0 !important;
  background: #e10600 !important;
  color: #fff !important;
  font-weight: 800;
  cursor: pointer;
  text-align: center;
}

.sticker-embed-button:hover{ filter: brightness(0.92); }

.sticker-embed-button:focus-visible{
  outline: 2px solid rgba(225, 6, 0, 0.35);
  outline-offset: 3px;
}

/* ---------- Body lock (optional) ---------- */
body.sc-lock{ overflow: hidden !important; }

/* =========================================================
   Modal: Sichtbarkeit
   Shopify / eigenes Script toggelt je nach Version:
   - aria-hidden="false"
   - .sticker-embed-modal--open
   - .sticker-embed-modal-open
   ========================================================= */

/* Default: verborgen (damit nichts „unsichtbar aber im Flow“ liegt) */
.sticker-embed-modal[aria-hidden="true"],
.sticker-embed-modal:not([aria-hidden]){
  display: none;
}

/* Offen (robust) */
.sticker-embed-modal[aria-hidden="false"],
.sticker-embed-modal--open,
.sticker-embed-modal-open{
  display: block;
  position: fixed !important;
  inset: 0 !important;
  width: 100vw !important;
  height: 100dvh !important;
  max-width: none !important;
  max-height: none !important;
  margin: 0 !important;
  padding: 0 !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  overflow: hidden !important;
  background: #0b0f14 !important;
  z-index: 2147483647 !important;
}

/* In Modal: React UI soll wirklich fullscreen ausfüllen (keine max-width Card) */
.sticker-embed-modal[aria-hidden="false"] .scWrap,
.sticker-embed-modal--open .scWrap,
.sticker-embed-modal-open .scWrap{
  max-width: none !important;
  height: 100% !important;
  min-height: 100% !important;
  border-radius: 0 !important;
  box-shadow: none !important;
}

/* Backdrop (falls vorhanden) */
.sticker-embed-backdrop,
.sticker-embed-backdrop-open,
.sc-modalOverlay{
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100dvh;
  background: rgba(0,0,0,.55);
  z-index: 2147483646;
}

/* Close Button (falls vorhanden) */
.sc-modalClose,
.sticker-embed-modal .sc-modalClose,
.sticker-embed-modal .sticker-embed-modal-close{
  position: fixed;
  top: 10px;
  right: 12px;
  width: 40px;
  height: 40px;
  border: 0;
  border-radius: 10px;
  background: rgba(255,255,255,.08);
  color: #fff;
  font-size: 26px;
  line-height: 1;
  cursor: pointer;
  z-index: 2147483647;
}

/* =========================================================
   Modal-Innenleben: React Root muss volle Fläche bekommen
   (damit dein UI überhaupt sichtbar ist)
   ========================================================= */

.sticker-embed-dialog,
.sticker-embed-modal-body,
.sc-modalBody{
  width: 100% !important;
  height: 100% !important;
  max-width: none !important;
  max-height: none !important;
  margin: 0 !important;
  padding: 0 !important;
  border-radius: 0 !important;
  overflow: hidden !important;
}

.sticker-embed-react-root{
  width: 100% !important;
  height: 100% !important;
  min-height: 0 !important;
  overflow: hidden !important;
}

/* Verhindert, dass Theme-Styles "button{width:...}" etc. das UI kaputt machen */
.sticker-embed-modal button,
.sticker-embed-modal select,
.sticker-embed-modal input{
  max-width: 100%;
}
/* =========================================================
   ✅ MOBILE FIX: 50/50 Preview + Settings + Scroll (iOS Safari)
   - Preview oben (50vh)
   - Konfigurator unten (50vh) + scrollbar
   ========================================================= */

@media (max-width: 900px) {
  /* Wichtig: Eltern dürfen Scroll nicht "abschneiden" */
  body.sc-overlay-open,
  body.sc-lock {
    overflow: hidden !important;
  }

  /* Modal nimmt volle Höhe ein */
  #sc-modal-root.sc-open,
  #sc-modal-root.sc-open .sticker-embed-modal,
  #sc-modal-root.sc-open .sticker-embed-dialog,
  #sc-modal-root.sc-open .sticker-embed-react-root {
    height: 100dvh !important;
    max-height: 100dvh !important;
    min-height: 0 !important;
    overflow: hidden !important;
  }

  /* ✅ WICHTIG: Keine nth-child-Logik, weil im React-Root ein <style> Tag als erstes Kind sitzt.
     Stattdessen direkt die bekannten Klassen aus StickerCanvasClient.jsx adressieren. */

  /* Container: oben Preview (fix), unten Settings (scroll) */
  #sc-modal-root.sc-open .sticker-embed-react-root .scWrap {
    height: 100dvh !important;
    max-height: 100dvh !important;
    min-height: 0 !important;

    /* überschreibt Desktop-Grid (40/60) */
    display: grid !important;
    grid-template-columns: 1fr !important;
    grid-template-rows: 50dvh 50dvh !important;
    width: 100% !important;
    max-width: none !important;
    margin: 0 !important;
    border-radius: 0 !important;
  }

  /* Preview oben – bleibt fest */
  #sc-modal-root.sc-open .sticker-embed-react-root .scWrap .scRight {
    grid-row: 1 !important;
    order: 0 !important;
    min-height: 0 !important;
    height: 50dvh !important;
    overflow: hidden !important;

    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 14px !important;
  }

  /* Settings unten – nur dieser Bereich scrollt */
  #sc-modal-root.sc-open .sticker-embed-react-root .scWrap .scLeft {
    grid-row: 2 !important;
    order: 0 !important;

    min-height: 0 !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;

    border-top: 1px solid rgba(255,255,255,0.08) !important;
    background: rgba(10, 14, 20, 0.92) !important;
    backdrop-filter: blur(10px);

    padding: 14px 14px calc(18px + env(safe-area-inset-bottom)) !important;
  }

  /* Optional: bessere Touch-Usability */
  #sc-modal-root.sc-open .sticker-embed-react-root .scWrap .scLeft * {
    scroll-margin-top: 12px;
  }

  /* Buttons full width (mobile) */
  #sc-modal-root.sc-open .sticker-embed-react-root button,
  body.sc-overlay-open [data-block-handle="sticker-configurator"] .sticker-embed-modal button {
    width: 100% !important;
  }
}

/* sehr kleine Höhen: Preview etwas weniger, damit Settings mehr Platz haben */
@media (max-width: 900px) and (max-height: 720px) {
  #sc-modal-root.sc-open .sticker-embed-react-root .scWrap {
    grid-template-rows: 44dvh 56dvh !important;
  }
  #sc-modal-root.sc-open .sticker-embed-react-root .scWrap .scRight {
    height: 44dvh !important;
  }
}
